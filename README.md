# Braille-Image
### Proof of concept project for detecting the main object in an image and projecting it on a Braille display for the visually impaired to feel.

## Увод
„Брайлов дисплей, при който идеята е от нормално изображение да се
намери главният обект и да се направи контурна графика на обекта, за да може
да се изобрази на брайловия дисплей чрез пинове, така че да може слепият
човек, опипвайки повдигнатите пинове, да разпознае/възприеме какво е
изображението на картината.“

![Alt text](/img/idea.png?raw=true)

Мотивацията ми за проекта дойде от горепосочената идея на доц. Светла Бойчева.
Не бих могъл да си представя живота без зрение и се възхищавам на незрящите хора,
които въпреки недостатъка си, се борят с живота. Ако създадената от мен програма
с изкуствен интелект помогне дори на един незрящ човек, бих бил изключително
доволен от постигнатото.

Целта на проекта е да се имплементират алгоритми с изкуствен интелект, които
да разпознават основният обект в дадено изображение. След като е разпознат,
той трябва да бъде извлечен от изображението, сякаш останалата част от
оригиналното изображение около него не съществува и да бъде представен на
брайлов дисплей чрез повдигнати пинове. Понеже нямам достъп до физически
брайлов дисплей, а и доколкото разбирам повечето такива са за текст (т.е.
вертикалната „резолюция“ е твърде малка), емулирам дисплея чрез графика, на
която спуснатите пинове са бели кръгчета, а повдигнатите – черни кръгчета.

## Преглед на областтa – Брайлови дисплеи
Брайлова азбука се нарича тактилна система за писане и четене, използвана от
слепите и слабовиждащите хора по света. Използва се в книги, менюта,
документи, бутоните на асансьорите, валута, лекарства. Брайловите символи
могат да се изписват на плоча с шило, като точките излизат релефни от другата
страна на листа или с брайлова машина. Брайловите потребители могат да четат
и от мониторите на компютрите и други електронни пособия, използвайки
брайлов дисплей. Повечето създадени брайлови дисплеи побират по 1 ред
брайлови символи, т.е. вертикалната им „резолюция“ няма достатъчно пинчета,
за да бъде изобразен обект. За целите на проекта си представяме, че имаме
брайлов дисплей с резолюция 100х100 пинчета, на който свалените пинове са
бели кръгчета, а повдигнатите – черни кръгчета.

## Реализация, тестване/експерименти
### Използвани технологии, платформи и библиотеки
Проектът е реализиран в Colab Notebook платформата на Google, написан е на
Python и са използвани следните основни библиотеки:

 - Tensorflow – библиотека, даваща много възможности, включително и работа с
невронни мрежи
 - Keras – работи върху Tensorflow и помага при работата с дълбоки невронни
мрежи
 - OpenCV – библиотека, предоставяща разширена функционалност за computer
vision задачи
 - Numpy – за по-лесна работа с числови данни, свързани с цветовете и пикселите
на изображенията
 - PIL, scikit-image, matplotlib – за работа с изображения и чертане на графики

### Реализация/Провеждане на експерименти
Реализирани са 2 Colab тетрадки – едната използва Fast R-CNN и алгоритъмът
Find Contours на OpenCV, който е способен да отделя обект в изображение от
фона. В другата тетрадка е използван Mask R-CNN, който директно връща точна
маска върху разпознатия обект, вместо правоъгълник с границите, както при
Fast R-CNN. Първият подход се справя по-добре с изображения, където има
само 1 обект или обектите са ясно разграничени един от друг без препокриване.
Също помага, когато има голям контраст между цветовете на фона и обекта.
Вторият подход блести пред първия, когато изображението има повече и/или
препокриващи се обекти, но е способен да разпознава само 80 обекта от
ежедневието. Обикновено вторият се справя по-зле, когато изображението има
само 1 обект с ясно изразен фон.

И в двете тетрадки накрая се чертае графика с matplotlib, която изобразява
виртуалния брайлов дисплей чрез кръгчета.

### Забележка:
resnet50_coco_best_v2.0.1.h5 моделът, използван при Mask R-CNN може да бъде изтеглен от [тук](https://github.com/OlafenwaMoses/ImageAI/releases/tag/1.0), понеже размерът му е твърде голям за GitHub.

## Заключение
В крайна сметка съм много доволен от получените резултати и голямата
точност на алгоритмите, особено на Mask R-CNN, които позволяват да бъде
изобразен обекта на брайлов дисплей.

Най-полезното развитие на проекта би било реалното създаване на таблет или
дисплей, на който физически да могат да се изобразяват обекти.

Използваните библиотеки и набори от данни могат да разпознават около 80
обекта от всекидневието. Друго примерно бъдещо развитие би могло да бъде
трениране на модел, който да разпознава други типове обекти.

Ако има dataset с обекти, извлечени от картинки, с премахнат фон, може да бъде
направено проучване с какво отклонение работи алгоритъма.

## Резултати
### Fast R-CNN Apple
![Alt text](/img/fast_rcnn_apple.png?raw=true)

### Fast R-CNN Statue of Liberty
![Alt text](/img/statue_of_liberty.jpg?raw=true)
![Alt text](/img/cropped_statue_of_liberty.png?raw=true)
![Alt text](/img/fast_rcnn_statue_of_liberty.jpg?raw=true)

### Mask R-CNN Bird and Person
![Alt text](/img/bird_person.png?raw=true)
![Alt text](/img/mask_rcnn_bird_person_masks.png?raw=true)
![Alt text](/img/mask_rcnn_bird_person.png?raw=true)

## Източници
https://towardsdatascience.com/object-detection-with-10-lines-of-code-d6cb4d86f606

https://www.analyticsvidhya.com/blog/2019/07/computer-vision-implementing-maskr-cnn-image-segmentation/

https://towardsdatascience.com/r-cnn-fast-r-cnn-faster-r-cnn-yolo-object-detectionalgorithms-36d53571365e

https://en.wikipedia.org/wiki/Object_detection

https://www.pyimagesearch.com/2019/06/10/keras-mask-r-cnn/

https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/

https://github.com/matterport/Mask_RCNN

https://www.docs.opencv.org/2.4/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html
